import{_ as se,M as oe,x as ne,r as v,N as le,c as ce,b as r,f as d,z as C,p as t,e as s,t as n,Y as J,g as ie,O as re,a3 as de,F as I,i as T,h as ue,m as p,a as u,k as K,l as ve,u as me,a4 as he}from"./index-CUj4cCHW.js";import{c as _e}from"./LXZindex-BrYxm-2E.js";const ge={class:"BuyTicket-Box"},pe={class:"Legend"},fe={class:"Seat-box"},we={class:"title"},ke=["src"],Se={class:"bottom-info"},ye={class:"movie-info"},Ce={class:"movie-top"},Ie={style:{color:"#6fa4e9"}},Te={class:"movie-time"},xe={class:"Switch-Sessions"},$e=["onClick"],Le={class:"title-itme"},be={class:"lang"},Be={key:0,class:"movie-bottom"},Ve={__name:"BuyTicket",setup(Ne){const b=oe(),{FilmImg:B,FilmObj:e}=ne(b);console.log("ChooseYourSeat",B.value,"123123",e.value);const{AddOrders:Ae,PayForTheOrder:Q}=b,V=ve();me();let a=v(null),N=null,A=null;_e().then(g=>{a.value=g.data.data,N=a.value.seat.image.selectedImages,A=a.value.seat.image.seatLegends[0].legendIcon,console.log("购票",a.value)});let h=v([]),w=v([]),_=v([]),x=v("请先选择座位"),$=v(0);le(()=>h.value,(g,o)=>{_=[...g],$.value=38*_.length,_.length==0?x="请先选择座位":x=`￥${$.value}  确认购买座位`,w=g.map(m=>`${m.rowId}排${m.columnId}座`),console.log("SeatArray座位",w)});function W(){_.length>=6&&he("一次最多购买6张票")}const M=ce(()=>{var y;const[g,o,m]=(y=e==null?void 0:e.value)==null?void 0:y.date.split("-");return`${o}月${m}日`});let l=v(0),k=v(!1),S=v({text:"切换场次",icon:"arrow-down"});function X(){k=!k,k?S.value={text:"收起场次",icon:"arrow-down"}:S.value={text:"切换场次",icon:"arrow-up"}}function Z(){console.log(w),Q({movieId:e==null?void 0:e.value.id,img:B.value,name:e==null?void 0:e.value.name,Seat:[...w],PlaceAnOrderTime:Date.now(),CMname:e==null?void 0:e.value.CMname,CinemaId:e==null?void 0:e.value.movid,lobbySeats:e==null?void 0:e.value.lobbySeats,TicketDate:e==null?void 0:e.value.date,OrderNumber:`${e==null?void 0:e.value.id}${Date.now()}`,isPay:!1,price:$.value,Playtime:`${a==null?void 0:a.value.relatedShow[l.value].showTime} - ${a==null?void 0:a.value.relatedShow[l.value].endTime}`,dateinfo:`${a==null?void 0:a.value.relatedShow[l.value].dateDesc}${M.value}${a==null?void 0:a.value.relatedShow[l.value].showTime}(${e.value.Language}${e.value.ScreenLevel})`}),V.push({name:"ordersdetali"})}return(g,o)=>{var z,D,P,R,Y,q,E,U,G,H;const m=p("van-icon"),y=p("van-nav-bar"),L=p("van-image"),F=p("van-checkbox"),O=p("van-checkbox-group"),j=p("van-button");return u(),r("div",ge,[d(y,{title:(z=t(e))==null?void 0:z.CMname,onClickLeft:o[0]||(o[0]=c=>t(V).back())},{right:C(()=>[d(m,{name:"wap-nav",size:"28rem",color:"#fff"})]),left:C(()=>[d(m,{name:"arrow-left",size:"28rem",color:"#fff"})]),_:1},8,["title"]),s("div",pe,[d(L,{width:"20rem",height:"20rem",src:(D=t(a))==null?void 0:D.seat.image.seatLegends[0].legendIcon},null,8,["src"]),o[2]||(o[2]=s("span",{class:"tl-icon"},"可选",-1)),d(L,{width:"20rem",height:"20rem",src:(P=t(a))==null?void 0:P.seat.image.seatLegends[1].legendIcon},null,8,["src"]),o[3]||(o[3]=s("span",{class:"tl-icon"},"已售",-1)),d(L,{width:"20rem",height:"20rem",src:(R=t(a))==null?void 0:R.seat.image.seatLegends[2].legendIcon},null,8,["src"]),o[4]||(o[4]=s("span",{class:"tl-icon"},"不可售",-1))]),s("div",fe,[s("div",we,n((Y=t(e))==null?void 0:Y.lobbySeats),1),d(O,{modelValue:t(h),"onUpdate:modelValue":o[1]||(o[1]=c=>J(h)?h.value=c:h=c),shape:"square",max:6},{default:C(()=>{var c;return[(u(!0),r(I,null,T((c=t(a))==null?void 0:c.seat.regions[0].rows,(i,f)=>(u(),r("div",{class:"seat-row",key:f},[s("div",{class:K(["icicon",(f==0?"start":!1)||(f==8?"end":!1)])},n(f+1),3),(u(!0),r(I,null,T(i==null?void 0:i.seats,(ee,te)=>(u(),r("div",{key:te},[d(F,{name:ee,onClick:W},{icon:C(ae=>[s("img",{class:"img-icon",src:ae.checked?t(N):t(A)},null,8,ke)]),_:2},1032,["name"])]))),128))]))),128))]}),_:1},8,["modelValue"])]),s("div",Se,[s("div",ye,[s("div",Ce,[s("div",{class:"title",onClick:X},[s("span",null,n((q=t(e))==null?void 0:q.name),1),s("span",Ie,[ie(n(t(S).text),1),d(m,{name:t(S).icon},null,8,["name"])])]),s("div",Te,n((E=t(a))==null?void 0:E.relatedShow[t(l)].dateDesc)+" "+n(M.value)+" "+n((U=t(a))==null?void 0:U.relatedShow[t(l)].showTime)+" - "+n((G=t(a))==null?void 0:G.relatedShow[t(l)].endTime)+" "+n(t(e).Language)+" "+n(t(e).ScreenLevel),1),re(s("div",xe,[(u(!0),r(I,null,T((H=t(a))==null?void 0:H.relatedShow,(c,i)=>(u(),r("div",{class:K(["Switch-Session-Data",i==t(l)?"Session-active":""]),key:i,onClick:f=>J(l)?l.value=i:l=i},[s("div",Le,n(c.showTime),1),s("div",be,n(t(e).Language)+n(t(e).ScreenLevel),1),o[5]||(o[5]=s("div",{class:"price"},"￥38元起",-1))],10,$e))),128))],512),[[de,t(k)]])]),t(_).length?(u(),r("div",Be,[(u(!0),r(I,null,T(t(h),(c,i)=>(u(),r("div",{class:"seat-info",key:i},[s("div",null,n(c.rowId)+"排"+n(c.columnId)+"座",1),o[6]||(o[6]=s("div",null,"￥38",-1))]))),128))])):ue("",!0)]),d(j,{round:"",type:"success",disabled:!t(_).length,text:t(x),onClick:Z},null,8,["disabled","text"])])])}}},De=se(Ve,[["__scopeId","data-v-761799c6"]]);export{De as default};
