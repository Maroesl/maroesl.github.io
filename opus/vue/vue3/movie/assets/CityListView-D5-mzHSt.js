import{d as A,w as B,x as T,r as k,y as $,a as n,b as a,e as l,f as u,p as _,t as f,g as b,F as h,i as g,j as L,z,l as P,A as U,m as d,_ as D}from"./index-CH_Ckgnz.js";const F={key:0,class:"title"},M={key:1,class:"title"},j={class:"mylocal"},K={key:1,class:"btn"},W={class:"mylocal"},q={class:"hot"},G=["onClick"],H=A({__name:"CityListView",setup(J){const E=P(),w=B(),{cityId:p,cityName:s,latitude:C,longitude:x}=T(w),O=()=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(t=>{C.value=t.coords.latitude,x.value=t.coords.longitude,U(C.value,x.value).then(e=>{console.log(e.data.data),p.value=e.data.data.id,s.value=e.data.data.city})},t=>{switch(t.code){case t.PERMISSION_DENIED:console.error("用户拒绝了地理位置请求。");break;case t.POSITION_UNAVAILABLE:console.error("位置信息不可用。");break;case t.TIMEOUT:console.error("请求用户位置超时。");break;case t.UNKNOWN_ERROR:console.error("未知错误发生了。");break}}):console.log("您的浏览器不支持地理位置API。")},i=k([]),I=k([]),y=k([]);$().then(t=>{console.log(t.data),y.value=t.data.cts.sort((e,o)=>e.py>o.py?1:e.py<o.py?-1:0);for(const e of y.value){const o=e.py[0].toUpperCase();if(!i.value.some(r=>r[0]===o))i.value.push([o,[e]]);else{const r=i.value.findIndex(m=>m[0]===o);i.value[r][1].push(e)}}I.value=t.data.hot});const R=t=>{let e=y.value.filter(o=>o.nm===t);console.log(e),p.value=e[0].id,s.value=t,E.replace("/")};return(t,e)=>{const o=d("van-icon"),r=d("van-search"),m=d("van-index-anchor"),S=d("van-cell"),V=d("van-index-bar");return n(),a("header",null,[l("header",null,[l("div",{class:"back",onClick:e[0]||(e[0]=c=>t.$router.back())},[u(o,{name:"arrow-left",size:"20rem",color:"#000"})]),_(s)?(n(),a("div",F,"当前位置 - "+f(_(s)),1)):(n(),a("div",M,"请打开定位"))]),u(r,{placeholder:"请输入搜索关键词"}),l("div",j,[e[2]||(e[2]=l("p",{class:"top"},"定位城市",-1)),_(s)?(n(),a("div",K,[u(o,{name:"location-o",size:"18",color:"#e54847"}),b(" "+f(_(s)),1)])):(n(),a("div",{key:0,class:"btn",onClick:O},[u(o,{name:"location-o",size:"18",color:"#e54847"}),e[1]||(e[1]=b("获取我的位置"))]))]),l("div",W,[e[3]||(e[3]=l("p",{class:"top"},"热门城市",-1)),l("ul",q,[(n(!0),a(h,null,g(I.value,c=>(n(),a("li",{onClick:N=>R(c)},f(c),9,G))),256))])]),(n(!0),a(h,null,g(i.value,(c,N)=>(n(),L(V,{key:N,"highlight-color":"#e54847"},{default:z(()=>[u(m,{index:c[0]},null,8,["index"]),(n(!0),a(h,null,g(c[1],v=>(n(),L(S,{key:v.id,title:v.nm,onClick:Q=>{p.value=v.id,s.value=v.nm,t.$router.replace("/")}},null,8,["title","onClick"]))),128))]),_:2},1024))),128))])}}}),Y=D(H,[["__scopeId","data-v-65369069"]]);export{Y as default};
